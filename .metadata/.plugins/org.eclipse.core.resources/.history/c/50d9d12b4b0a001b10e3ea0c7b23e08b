#include "ee.h"
#include "Arduino.h"
#include "HelpfulSerial.h"
#include "MyArduino.h"
#include "stdio.h"

#define BUFSIZ 128

extern HelpfulSerial *serial;

void StartupHook() {
	char buff[BUFSIZ];

	serial->println("hook.cpp: Hello!!! I'am StartupHook and I am here!!!");

	GetResource(RES_DDRD_REG);
	GetResource(RES_PORTD_REG);

	DDRD |= (MASK(3) | MASK(7));
	PORTD &= ~(MASK(3) | MASK(7));

	sprintf(buff, "hook.cpp: DDRD=[0x%x]\tPORTD=[0x%x]", DDRD, PORTD);

	ReleaseResource(RES_DDRD_REG);
	ReleaseResource(RES_PORTD_REG);

	serial->println(buff);
}
